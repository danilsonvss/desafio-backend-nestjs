---
alwaysApply: true
---

O projeto trata-se de uma API RestFull, criada com  NodeJs, TypeScript, NestJs, Prisma, PostgresSQL e Docker.

# **ğŸ¯ Plano de AÃ§Ã£o Global**

Desenvolver uma API RESTful que:

- Simule a existÃªncia de um Ãºnico produto com um produtor, um coprodutor e afiliado jÃ¡ definidos, apenas para fins de teste do fluxo.
- Receba dados de vendas nacionais e internacionais;
- Calcule taxas e comissÃµes conforme regras de negÃ³cio;
- Registre repasses para produtores, afiliados, coprodutores e plataforma;
- Atualize saldos individuais conforme cada transaÃ§Ã£o.

## **ğŸ—‚ï¸ Arquitetura Implementada**

- âœ… Arquitetura Modular com DDD (Domain-Driven Design)
- âœ… Clean Architecture (domain, application, infrastructure, presentation)
- âœ… TDD (Test-Driven Development) - 48 testes unitÃ¡rios + 14 E2E
- âœ… Testes de integraÃ§Ã£o
- âœ… Escalabilidade Horizontal
- âœ… Global Exception Filter
- âœ… Transform Interceptor para padronizaÃ§Ã£o de respostas
- âœ… SharedModule global para recursos compartilhados
- âœ… InjeÃ§Ã£o de dependÃªncia com tokens centralizados

## **ğŸ§± Funcionalidades - Status**

### 1. âœ… Cadastro e autenticaÃ§Ã£o de usuÃ¡rio [CONCLUÃDO]
- âœ… CriaÃ§Ã£o de usuÃ¡rios
- âœ… Perfis distintos: produtor, afiliado, coprodutor e plataforma
- âœ… AutenticaÃ§Ã£o JWT
- âœ… Guards e decorators para proteÃ§Ã£o de rotas
- âœ… Hash de senhas com bcrypt
- âœ… Response DTOs tipados
- âœ… ValidaÃ§Ã£o completa de dados
- âœ… 48 testes unitÃ¡rios passando
- âœ… 14 testes E2E passando

### 2. â³ Sistema de taxas [PENDENTE]
- Taxas configurÃ¡veis via banco de dados
- DiferenciaÃ§Ã£o por paÃ­s (nacional/internacional)
- Entidade Tax no domÃ­nio

### 3. â³ AfiliaÃ§Ã£o e coproduÃ§Ã£o [PENDENTE]
- ConfiguraÃ§Ã£o de percentuais de comissÃ£o entre:
  - Produtor
  - Afiliado
  - Coprodutor
  - Plataforma (tambÃ©m pode reter comissÃ£o)
- Entidades de relacionamento entre usuÃ¡rios

### 4. â³ Sistema de balances [PARCIAL]
- âœ… Tabela de saldo por usuÃ¡rio (schema pronto)
- â³ OperaÃ§Ãµes de crÃ©dito/dÃ©bito
- â³ AtualizaÃ§Ã£o de saldos conforme transaÃ§Ãµes
- â³ HistÃ³rico de transaÃ§Ãµes

### 5. â³ Pagamento de venda [PENDENTE]
- Rota POST /payment
- Recebe valor, paÃ­s, participantes
- Simula aprovaÃ§Ã£o imediata (nÃ£o integrar adquirentes reais)
- Calcula taxas por paÃ­s
- Aplica comissÃµes para cada participante
- Atualiza transaÃ§Ãµes e saldos

### 6. âœ… Boas prÃ¡ticas de seguranÃ§a (LGPD + PCI) [IMPLEMENTADO]
- âœ… Armazenamento seguro de dados sensÃ­veis (hash bcrypt)
- âœ… Senhas nunca retornadas nas respostas
- âœ… ValidaÃ§Ã£o de dados de entrada
- âœ… Controle de acesso conforme papel do usuÃ¡rio
- âœ… JWT com secret configurÃ¡vel
- âœ… Response DTOs que nÃ£o expÃµem dados sensÃ­veis

## **ğŸ› ï¸ Tecnologias Esperadas**

VocÃª pode utilizar:

    - Node.js com TypeScript;
    - NestJS;
    - PostgreSQL;
    - Prisma.
    - Docker;
    - Testes unitÃ¡rios e de integraÃ§Ã£o;
    - DocumentaÃ§Ã£o Swagger ou similar.

## **ğŸ“¦ Entrega**

    - Suba o cÃ³digo em um repositÃ³rio pÃºblico no GitHub.
    - Inclua um README com:
        - InstruÃ§Ãµes para rodar o backend;
        - Scripts de inicializaÃ§Ã£o e migraÃ§Ã£o de banco;
        - ExplicaÃ§Ã£o das regras de negÃ³cio implementadas.

## **âœ… CritÃ©rios de AvaliaÃ§Ã£o**

- OrganizaÃ§Ã£o e clareza do cÃ³digo;
- Arquitetura e boas prÃ¡ticas;
- SeguranÃ§a no armazenamento de dados;
- CorreÃ§Ã£o nas regras de taxas e comissÃµes;
- Uso eficiente do banco de dados;
- Clareza da documentaÃ§Ã£o.
